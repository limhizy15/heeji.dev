---
title: 'ë¦¬ì•¡íŠ¸ì˜ Suspenseë¥¼ í™œìš©í•´ ì„ ì–¸ì ìœ¼ë¡œ UIë¥¼ ì‘ì„±í•´ë³´ì'
date: '2023-11-07'
description: 'Suspenseê°€ ë¬´ì—‡ì¸ì§€ ì•Œì•„ë³´ê³  í™œìš© ì˜ˆì œë¥¼ ì‘ì„±í–ˆë‹¤.'
tags: ['react']
---

# ë¦¬ì•¡íŠ¸ì˜ Suspenseë¥¼ í™œìš©í•´ ì„ ì–¸ì ìœ¼ë¡œ UIë¥¼ ì‘ì„±í•´ë³´ì

Reactì—ì„œ ë°ì´í„°ë¥¼ fetchí•˜ê³  ë¡œë”©ì¤‘ì¸ì§€ ì—ëŸ¬ê°€ ë°œìƒí–ˆëŠ”ì§€ë¥¼ íŒë³„í•˜ê³  ê·¸ì— ë§ëŠ” UIë¥¼ ë³´ì—¬ì£¼ëŠ” ì‘ì—…ì€ ìì£¼ ë°˜ë³µë˜ëŠ” ì¼ì´ë‹¤. ì´ë²ˆì— íšŒì‚¬ì—ì„œ React 18ë¡œ ì—…ê·¸ë ˆì´ë“œ í•˜ë©´ì„œ ì¼ë¶€ë¶„ì— ì´ê²ƒì„ ì„ ì–¸ì ìœ¼ë¡œ ì‘ì„±í•  ìˆ˜ ìˆê²Œ ë„ì™€ì£¼ëŠ” Suspenseë¥¼ ë„ì…í–ˆë‹¤.

ì´ ê¸€ì—ì„œëŠ” Suspenseê°€ ë¬´ì—‡ì¸ì§€ ì•Œì•„ë³´ê³  ì‹¤ì œë¡œ ì ìš©í•˜ëŠ” ì˜ˆì‹œë¥¼ ë³´ì—¬ì£¼ë ¤ê³  í•œë‹¤.

## Suspenseë€?

Reactì—ì„œ ì œì‹œí•œ ë™ì‹œì„± ì»¨ì…‰ê³¼ ê´€ë ¨ëœ ê²ƒì´ë‹¤. SuspenseëŠ” ë¹„ë™ê¸°ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ê±°ë‚˜ ì»´í¬ë„ŒíŠ¸ë¥¼ dynamic importí•  ë•Œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ì§€ì—° ì‹œê°„ì„ ë” íš¨ê³¼ì ìœ¼ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì¤€ë‹¤.

Suspenseë¥¼ í™œìš©í•˜ë©´ ë¹„ë™ê¸° ë¡œì§ì„ ì»´í¬ë„ŒíŠ¸ì˜ ìƒìœ„ ìˆ˜ì¤€ì—ì„œ ì²˜ë¦¬í•  ìˆ˜ ìˆì–´ ë³µì¡ì„±ì„ ì¤„ì´ê³  ìœ ì§€ ë³´ìˆ˜ê°€ ìš©ì´í•´ì§„ë‹¤. ë˜ ì„ ì–¸ì ìœ¼ë¡œ ë¹„ë™ê¸° ë¡œì§ì„ ì‘ì„±í•  ìˆ˜ ìˆë‹¤. â€œë¬´ì—‡â€ì„ ê·¸ë¦°ë‹¤ì— ë” ì§‘ì¤‘í•  ìˆ˜ ìˆë„ë¡ í•´ì¤€ë‹¤.

### lazy import

ì½”ë“œ ìŠ¤í”Œë¦¬íŒ…ì„ í•  ë•Œ ì»´í¬ë„ŒíŠ¸ë¥¼ lazy importí•˜ê³  ì´ë¥¼ Suspenseë¡œ ê°ì‹¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë™ì•ˆ í´ë°±ì„ ë…¸ì¶œí•˜ëŠ”ë° ì‚¬ìš©ëœë‹¤.

```jsx
import React, { lazy, Suspense } from 'react'

const LazyComponent = lazy(() => import('./LazyComponent'))

function App() {
  return (
    <Suspense fallback={<div>ë¡œë”© ì¤‘...</div>}>
      <LazyComponent />
    </Suspense>
  )
}

export default App
```

### ë¹„ë™ê¸° ë¡œì§

ë¹„ë™ê¸° ë¡œì§ì„ ìˆ˜í–‰ ì¤‘ì´ê±°ë‚˜ ì‹¤íŒ¨ê°€ ë°œìƒí–ˆì„ ë•Œ ìš°ë¦¬ëŠ” ì ì ˆí•˜ê²Œ UIë¥¼ ë…¸ì¶œì‹œí‚¨ë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì•„ë˜ì™€ ê°™ì´ ë¶„ê¸°ë¬¸ì„ í†µí•´ ì´ë¥¼ ìˆ˜í–‰í•œë‹¤.

```jsx
if (isLoading) {
  return <div>Loading..</div>
}

if (isError) {
  return <div>Error!</div>
}
```

React Suspenseë¥¼ í™œìš©í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ ëŒ€ì²´í•  ìˆ˜ ìˆë‹¤. isError êµ¬ë¬¸ì€ ErrorBoundaryë¥¼ ì‚¬ìš©í•´ í´ë°±ì„ ë³´ì—¬ì£¼ë„ë¡ í•  ìˆ˜ ìˆë‹¤.

```jsx
<Suspense fallback={<Spinner />}>
  <Comments />
</Suspense>
```

## Suspense í™œìš© ì˜ˆì œ

íšŒì‚¬ì—ì„œ ìš”êµ¬ì‚¬í•­ì— ë¸Œëœë“œ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ê³  ì´ ë¸Œëœë“œì— ë“±ë¡ëœ ìƒí’ˆ ëª©ë¡ì„ ë¶ˆëŸ¬ì™€ì„œ ë³´ì—¬ì£¼ëŠ” ìš”êµ¬ì‚¬í•­ì´ ìˆì—ˆë‹¤. ì´ë¥¼ ê°„ì†Œí™”í•œ ë²„ì „ì´ë‹¤.

<img
  src={
    'https://github-production-user-asset-6210df.s3.amazonaws.com/41099712/280239657-8d5ed426-52cc-4fc8-b6cc-7a20c74c69a7.png'
  }
/>

ë¸Œëœë“œ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ê³  ë¦¬ìŠ¤íŒ…í•˜ëŠ” UIë¥¼ ì‘ì„±í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

```jsx
export default function ReactSuspensePage() {
  const { data } = useBrands()

  return (
    <StyledContainer>
      {data?.map((brand) => (
        <BrandSection key={brand.id} id={brand.id} />
      ))}
    </StyledContainer>
  )
}

const StyledContainer = styled('section')`
  display: flex;
  flex-direction: column;
`
```

BrandSectionì€ ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•  ìˆ˜ ìˆë‹¤. ë¸Œëœë“œ ì•„ì´ë””ë¡œ ë“±ë¡ëœ ìƒí’ˆì„ ë¶ˆëŸ¬ì˜¤ê³  ì œëª©ì„ ë…¸ì¶œí•œë‹¤.

```jsx
function BrandSection({ id }: { id: string }) {
  const { data } = useItemsByBrand({ brandID: id });

  return (
    <span>
      <h1>{id}</h1>
      {data?.map((item) => <span key={item.id}>{item.title}</span>)}
    </span>
  );
}
```

ë°ì´í„°ë¥¼ ë¹„ë™ê¸°ë¡œ ë¶ˆëŸ¬ì˜¤ëŠ” ë™ì•ˆ Suspenseë¡œ fallbackì„ ë…¸ì¶œí•˜ë„ë¡ BrandSectionì„ Suspenseë¡œ ê°ì‹¸ì¤€ë‹¤.

```jsx
export default function ReactSuspensePage() {
  const { data } = useBrands();

  return (
    <StyledContainer>
      {data?.map((brand) => (
        <Suspense
          key={brand.id}
          fallback={
            <StyledLoadingContainer>
              <p>LoadingğŸ”œ</p>
            </StyledLoadingContainer>
          }
        >
          <BrandSection id={brand.id} />
        </Suspense>
      ))}
    </StyledContainer>
  );
}

=-==

const StyledContainer = styled("section")`
  display: flex;
  flex-direction: column;
`;

const StyledLoadingContainer = styled("div")`
  min-height: "160px";
`;
```

<img
  src={
    'https://github-production-user-asset-6210df.s3.amazonaws.com/41099712/280238828-f5edf4e5-9285-4f11-b2a2-13cdb9579047.gif'
  }
/>

í˜„ì¬ëŠ” ê°„ë‹¨í•œ ì˜ˆì œë¼ í‹°ê°€ ì˜ ì•ˆë‚˜ì§€ë§Œ boilerplateë¥¼ ì¤„ì¼ ìˆ˜ ìˆê³  ì„ ì–¸í˜•ìœ¼ë¡œ ì‘ì„±í•˜ëŠ”ë° ì´ì ì„ ì–»ì„ ìˆ˜ ìˆë‹¤.

## ì°¸ê³ 

- [React Queryì™€ í•¨ê»˜ Concurrent UI Patternì„ ë„ì…í•˜ëŠ” ë°©ë²•](https://tech.kakaopay.com/post/react-query-2/#%EB%B3%B5%EC%9E%A1%ED%95%9C-ui-%EA%B5%AC%EC%84%B1%EC%8B%9C-%EB%B9%9B%EC%9D%B4-%EB%82%98%EB%8A%94-%EC%84%A0%EC%96%B8%ED%98%95-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8)
- [TanStack Query - Suspensive React Query](https://tanstack.com/query/v4/docs/react/community/suspensive-react-query)
- [Suspensive - Delay](https://suspensive.org/ko/docs/react/Delay)
- [React Query useSuspenseQuery: Render Your Components Without Blocking the UI](https://medium.com/@bobjunior542/react-query-usesuspensequery-render-your-components-without-blocking-the-ui-e3c9d6d13c96)
